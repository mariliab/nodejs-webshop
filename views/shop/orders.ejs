<!DOCTYPE html>
<html lang="en">
    <%- include('../includes/head.ejs') %>
    <link rel="stylesheet" href="/css/products.css">
</head>
<body>
    <%- include('../includes/navigation.ejs') %>
    <main id="orders">
        <% if (isAuthenticated) { %>
        <div class="page-header">
            <h1>Orders</h1>
        </div>
        <% if (orders.length > 0) { %>
                    <% orders.forEach( order => { %>
                        <h2>Order <%= order._id %></h2>
                        <table class="orders">
                            <thead>
                                <tr>
                                    <th>
                                        Products
                                    </th>
                                    <th>
                                        Quantity
                                    </th>
                                    <th>
                                        Price
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <% order.products.forEach( p => { %>
                                    <tr>
                                    <td>
                                    <p><%= p.product.title %></p>
                                    </td>
                                    <td>
                                        <p><%= p.quantity %></p>
                                    </td>
                                    <td>
                                        <p><%= p.product.price %></p>
                                    </td>
                                    </tr>
                                <% }); %>
                            </tbody>
                            <tfoot>
                                <tr><td>
                                    Total price: <%= order.totalPrice %> kr
                                </td></tr>
                            </tfoot>
                        </table>
                    <% }); %>
        <% } else { %>
            <p>No orders yet..</p>
        <% } %>
        <% } else { %>
            <p>Du måste logga in för att se detta</p>
        <% } %>
    </main>
<%- include('../includes/end.ejs') %>